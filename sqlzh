ALTER SESSION SET CURRENT_SCHEMA = ZOO;

SELECT * FROM ZOO_ELELEM;
SELECT * FROM ZOO_ELELEM_TIPUS;
SELECT * FROM ZOO_ELLENORZES;
SELECT * FROM ZOO_ETREND;
SELECT * FROM ZOO_FAJ_ETREND;
SELECT * FROM ZOO_FAJOK;
SELECT * FROM ZOO_ALLATOK;

SELECT * FROM ZOO_ALLATOK WHERE LOWER(ERKEZES_HELY) LIKE 'pixar';
SELECT ALLAT_NEV AS "Ismeretlen forrásból származó állatok" FROM ZOO_ALLATOK WHERE ERKEZES_HELY IS NULL ORDER BY ALLAT_NEV DESC;
SELECT COUNT(ALLAT_AZON) FROM ZOO_ALLATOK WHERE ERKEZES_HELY LIKE 'D*' OR FAJ_AZON = 4 OR FAJ_AZON = 2 OR FAJ_AZON = 14;
SELECT * FROM ZOO_ALLATOK WHERE ERKEZES_MAG BETWEEN 100 AND 150 AND ERKEZES_SULY < 20;
SELECT FLOOR(EXTRACT(YEAR FROM SZUL_DAT)/100) FROM ZOO_ALLATOK;
SELECT EXTRACT(YEAR FROM SZUL_DAT) FROM ZOO_ALLATOK;
SELECT * FROM ZOO_ALLATOK WHERE EXTRACT(YEAR FROM SZUL_DAT)-FLOOR(EXTRACT(YEAR FROM SZUL_DAT)/100)*100 BETWEEN 80 AND 100;
SELECT * FROM ZOO_ALLATOK WHERE EXTRACT(YEAR FROM SZUL_DAT) BETWEEN 80 AND 100;
SELECT COUNT(*) as "macskafogóból érkező állatok száma",AVG(ERKEZES_MAG) AS "átlag magasság",MAX(ERKEZES_SULY) AS "legnehezebb állat",MIN(ERKEZES_SULY) as "legkönnyebb állat" FROM ZOO_ALLATOK WHERE ERKEZES_HELY = 'Macskafogó';
SELECT COUNT(*) AS "Nők száma",ERKEZES_HELY FROM ZOO_ALLATOK WHERE NEM = 'n' group by ERKEZES_HELY;
SELECT MAX(ERKEZES_SULY) FROM (SELECT * FROM ZOO_ALLATOK WHERE ERKEZES_HELY = 'Kashyyk' OR ERKEZES_HELY = 'Disney') group by ERKEZES_HELY;
SELECT ALLAT_NEV,ERKEZES_SULY FROM ZOO_ALLATOK INNER JOIN (SELECT MAX(ERKEZES_SULY) AS "maxsuly" FROM (SELECT * FROM ZOO_ALLATOK WHERE ERKEZES_HELY = 'Kashyyk' OR ERKEZES_HELY = 'Disney') group by ERKEZES_HELY) ON ZOO_ALLATOK.ERKEZES_SULY = "maxsuly";

SELECT * FROM ZOO_FAJOK WHERE ELOHELY NOT LIKE 'barlang';

SELECT count(*) AS "nem barlangban lakók száma" FROM ZOO_ALLATOK INNER JOIN ZOO_FAJOK ON ZOO_ALLATOK.FAJ_AZON = ZOO_FAJOK.FAJ_AZON WHERE ELOHELY NOT LIKE 'barlang'; 

SELECT * FROM ZOO_ELELEM WHERE ETEL_NEV = 'Paprikás krumpli';

SELECT ALLAT_NEV FROM ZOO_ALLATOK 
INNER JOIN ZOO_FAJOK ON ZOO_ALLATOK.FAJ_AZON = ZOO_FAJOK.FAJ_AZON 
INNER JOIN ZOO_FAJ_ETREND ON ZOO_FAJOK.FAJ_AZON = ZOO_FAJ_ETREND.FAJ_AZON
INNER JOIN ZOO_ELELEM ON ZOO_FAJ_ETREND.ETEL_AZON = ZOO_ELELEM.ETEL_AZON
WHERE ELOHELY = 'ház' AND ETEL_NEV = 'Paprikás krumpli';



